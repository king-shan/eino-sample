
## ChatTemplate 使用说明
Prompt 组件是一个用于处理和格式化提示模板的组件。它的主要作用是将用户提供的变量值填充到预定义的消息模板中，生成用于与语言模型交互的标准消息格式。这个组件可用于以下场景：
- 构建结构化的系统提示
- 处理多轮对话的模板 (包括 history)
- 实现可复用的提示模式

## RAG:检索增强生成
### 一、为什么需要？ 
1. 减少大模型幻觉现象，提高回答的准确性和相关度
2. 构建专门领域的回答资料库
### 二、小抄：RAG概念
RAG 的核心思想是在LLM生成回复之前，先去外部数据源中查找相关信息，然后将这些信息作为额外上下文提供给LLM，引导其生成更准确的回答。

在我看来，RAG就是ai应用开发的**核心**，对于ai的基础应用来说是地基，因为如果要投入使用或者加入到生产阶段，**高可用**是必要的，一定要做到**稳定、准确**才能实际使用

### 三、RAG三步走：数据准备（做小抄） -> 检索（看小抄） -> 增强（写答案）
1. 数据准备（索引）
- **收集和处理外部数据（提前搜集）：** 将各种形式的外部数据（如文档、数据库、网页、API等）收集起来。这些数据可以是企业的内部知识库，也可以是互联网上的公开信息。
- **切分和嵌入（Transformer）：** 将这些数据切分成小块（称为“chunk”），并使用嵌入模型将每个小块转换为高维度的数字向量（称为“嵌入”）。这些嵌入能够捕捉文本的语义信息。
- **存储到向量数据库（Embedding&indexer）：** 将这些向量存储在专门的**向量数据库**中，以便后续进行高效的相似性搜索。
2. 检索（Reteriever）
- **用户查询：** 当用户提出问题或输入查询时，RAG系统会首先将这个查询也转换为一个向量。
- **相似性搜索：** 然后，系统会在向量数据库中进行相似性搜索，找到与用户查询最相关的文档块（或片段）。这个过程就像在海量信息中找到最相关的“证据”。
3. 增强生成
- **构建增强提示：** 将用户原始的查询和从向量数据库中检索到的相关信息（作为上下文）一起发送给大型语言模型。
- **LLM 生成回答：** LLM在接收到这个“增强”后的提示后，会根据其自身的训练知识和提供的外部上下文来生成最终的回答。这样，LLM不再仅仅依赖于其训练时的数据，而是有了“实时”的参考资料。

## 文本向量化：Embedding组件
Embedding 组件是一个用于将文本转换为向量表示的组件。它的主要作用是将文本内容映射到向量空间，使得语义相似的文本在向量空间中的距离较近。这个组件在以下场景中发挥重要作用：
- 文本相似度计算
- 语义搜索
- 文本聚类分析

## 做小抄：Indexer组件
Indexer 组件是一个用于**存储和索引**文档的组件。它的主要作用是将文档及其向量表示**存储**到后端存储系统中，并提供高效的检索能力。这个组件在以下场景中发挥重要作用：
- 构建向量数据库，以用于语义关联搜索

## 翻小抄：Retriever组件
Retriever 组件是一个用于从各种数据源检索文档的组件。它的主要作用是根据用户的查询（query）从文档库中检索出最相关的文档。这个组件在以下场景中特别有用：
- 基于向量相似度的文档检索
- 基于关键词的文档搜索
- 知识库问答系统 (rag)

## 细细切作臊子：Transformer组件
Document Transformer 是一个用于文档转换和处理的组件。它的主要作用是对输入的文档进行各种转换操作，如分割、过滤、合并等，从而得到满足特定需求的文档。这个组件可用于以下场景中：
- 将长文档分割成小段落以便于处理
- 根据特定规则过滤文档内容
- 对文档内容进行结构化转换
- 提取文档中的特定部分

## 拿拿拿拿起了工具：Tool组件

ToolsNode 组件是一个用于扩展模型能力的组件，它允许模型调用外部工具来完成特定的任务。这个组件可用于以下场景中：

- 让模型能够获取实时信息（如搜索引擎、天气查询等）
- 使模型能够执行特定的操作（如数据库操作、API 调用等）
- 扩展模型的能力范围（如数学计算、代码执行等）
- 与外部系统集成（如知识库查询、插件系统等）

## 链式chain编排 是 Graph编排里的一种
- Chain 可以视为是 Graph 的简化封装
- state 历史对话记忆功能：上次输出结果保存，然后和下一次会话一起通过api发送给大模型
- callback 切面：可以插入一个功能，通过一个回调函数实现，不影响整个编排的流程（比如想知道模型最后的输出结果）
- 边就是数据的流向
 
## Lambda
- Lambda 是 Eino 中最基础的组件类型，它允许用户在工作流中嵌入自定义的函数逻辑。
- Lambda 组件底层是由输入输出是否流所形成的 4 种运行函数组成，对应 4 种交互模式: Invoke、Stream、Collect、Transform。

## State
### 定义

**State**：在 NewGraph 时通过 `compose.WithGenLocalState` 传入 State 的创建方法。这个请求维度的全局状态在一次请求的各环节可读写使用。

Eino 推荐用 `StatePreHandler` 和 `StatePostHandler`，功能定位是：

- StatePreHandler：在每个节点执行前读写 State，以及按需替换节点的 Input。输入需对齐节点的非流式输入类型。
- StatePostHandler：在每个节点执行后读写 State，以及按需替换节点的 Output。输入需对齐节点的非流式输出类型。
#### 针对流式场景，使用对应的 `StreamStatePreHandler` 和 `StreamStatePostHandler`，输入需分别对齐节点的流式输入和流式输出类型。
这些 state handlers 位于节点外部，通过对 Input 或 Output 的修改影响节点，从而保证了节点的“**状态无关**”特性。

## callback
### 定义
核心概念串起来，就是：Eino 中的 Component 和 Graph 等**实体**，在固定的**时机** (Callback Timing)，回调用户提供的 **function** (Callback Handler)，并把**自己是谁** (RunInfo)，以及**当时发生了什么** (Callback Input & Output) 传出去。

## Eino Dev：应用开发工具链
#### Eino 是 Go AI 集成组件的研发框架，提供常用的 AI 组件以及集成组件编排能力。为了更好的辅助开发者使用 Eino，我们提供了「Eino Dev」插件，助力 AI 应用高效开发 🚀。